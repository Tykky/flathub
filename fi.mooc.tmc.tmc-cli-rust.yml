app-id: fi.mooc.tmc.tmc-cli-rust
runtime: org.freedesktop.Platform
runtime-version: '19.08'
sdk: org.freedesktop.Sdk
command: tmc
finish-args:
    - --share=network
    - --filesystem=host
modules:
  - name: tmc
    buildsystem: simple
    build-commands:
      - install -D ./run.sh /app/bin/tmc
      - install tmc-i686 /app/bin
      - install tmc-x86_64 /app/bin
      - install -Dm644 metainfo.xml /app/share/appdata/fi.mooc.tmc.tmc-cli-rust
    sources:
      - type: file
        url: https://download.mooc.fi/tmc-cli-rust/tmc-cli-rust-x86_64-unknown-linux-gnu-v0.2.4
        sha256: 7b2909ae173f413c3ed5fee2ec7c09be75bafe885d2156498aff6a072b0ecfb6
        dest-filename: tmc-x86_64
      - type: file
        url: https://download.mooc.fi/tmc-cli-rust/tmc-cli-rust-i686-unknown-linux-gnu-v0.2.4
        sha256: dcd40ebf839cc999b315672a41d53e1e7e2d5cce8b889bd2d2ec235d1f56f2b9
        dest-filename: tmc-i686
      - type: script
        commands:
          - arch=$(uname -m)
          - if [ $arch == "x86_64" ]
          - then
          -  /app/bin/tmc-x86_64 "$@"
          - elif [ $arch == "i686" ]
          - then
          -  /app/bin/tmc-i686 "$@"
          - else
          - echo "No executable found for $arch"
          - fi
        dest-filename: run.sh